# Git快速入门与团队协作规范

- **标题**: Git快速入门与团队协作规范
- **文档目的**: 帮助新成员快速融入`Radar MVP`项目开发流程，掌握团队Git协作方法。
- **目标读者**: 刚加入项目的新成员。
- **前置要求**: 已完成Git基础安装和[基本配置](https://git-scm.com/book/zh/v2)。
- **关联文档**: 本文档是 **[Git完整使用指南.md](./Git完整使用指南.md)** 的快速实践版。遇到不理解的命令或概念，请查阅该完整指南。

---

## 欢迎加入！从这里开始

你好，新伙伴！

为了让你能快速、自信地提交你的第一行代码，我们准备了这份“保姆级”的Git实战指南。它不会罗列所有Git命令，而是聚焦于我们团队的协作流程。

**核心理念：** 我们通过一套简单、安全的分支规则来保证项目稳定。你只管在自己的“沙盒”（功能分支）里尽情发挥，完成后再申请并入主干道（开发分支）。

---

## 我们的分支约定（Git Flow精简版）

想象一下我们的代码仓库有三条关键的“泳道”：

1.  `main` **(生产发布泳道)**
    - **作用**: 这是最干净、最稳定的版本，代表了可以随时交付给客户的正式产品。
    - **规则**: **任何人都不能直接向`main`提交代码！** 它只接受来自`release`或`hotfix`分支的合并。

2.  `develop` **(主开发泳道)**
    - **作用**: 这是所有新功能的“集散地”。我们在这里集成所有已完成的功能，并进行集成测试。
    - **规则**: **你不能直接向`develop`提交代码！** 你的代码必须通过“功能分支”和“Pull Request”流程才能进入这里。

3.  `feature/<your-feature-name>` **(你的个人工作泳道)**
    - **作用**: 这是你的专属工作区！无论是开发新功能、修复Bug，还是写文档，你都应该在这里进行。
    - **规则**: 从`develop`分支创建，以`feature/`开头命名，开发完成后合并回`develop`。

---

## 你的第一个开发任务：实战演练

假设你接到了一个任务：“实现一个新的数据解析器”。下面是你的完整操作步骤：

### 第1步：准备工作区（拉取最新代码）

在开始新任务前，务必确保你的`develop`分支是最新版本。

```powershell
# 1. 切换到主开发分支
git checkout develop

# 2. 从远程仓库拉取最新的代码
git pull origin develop
```
> **为什么？** 这样可以确保你的新功能是基于项目的最新进展来开发的，从而避免未来的合并冲突。

### 第2步：创建你的功能分支

为你的任务创建一个专属分支。分支命名要清晰，格式为 `feature/任务简称`。

```powershell
# 从最新的develop分支创建并切换到你的新分支
git checkout -b feature/data-parser
```
> **为什么？** 这为你提供了一个隔离的“沙盒”，你在这里的任何操作都不会影响到主开发分支，可以放心大胆地实验。

### 第3步：编码、测试、提交

现在你可以在新分支上安心工作了。遵循“小步快跑”的原则。

```powershell
# 1. 编写你的代码，比如修改了 processor.cpp 和 processor.h
#    ... (coding and local testing) ...

# 2. 将你的修改添加到暂存区
git add src/modules/data_processor/

# 3. 提交你的修改，并写下清晰的提交信息
git commit -m "feat(parser): 实现基础数据解析框架"

# ... 重复这个循环，直到功能完成 ...
git add .
git commit -m "feat(parser): 添加对二进制格式的支持并完成单元测试"
```
> **提交信息规范**:
> - `feat`: 新功能
> - `fix`: 修复Bug
> - `docs`: 修改文档
> - `refactor`: 代码重构
>
> **为什么？** 频繁的小提交就像游戏存档，让你随时可以回溯到某个稳定状态，也让其他人更容易理解你的工作进展。

### 第4步：分享你的成果（推送与Pull Request）

当你完成了功能开发和本地测试后，就可以准备将你的代码合并到`develop`分支了。

```powershell
# 将你的功能分支推送到远程仓库
git push -u origin feature/data-parser
```
- `-u` 参数只需在第一次推送时使用，它会建立本地分支与远程分支的链接。

推送完成后，**在浏览器中打开你的GitHub仓库页面**。你会看到一个黄色的提示条，引导你为刚刚推送的分支创建一个 **Pull Request (PR)**。

- **目标分支**: `develop`
- **源分支**: `feature/data-parser`
- **标题**: 清晰地描述你的PR是做什么的，例如 `feat(parser): 实现数据解析器`
- **描述**: 详细说明你做了什么、解决了什么问题、如何测试。

### 第5步：代码审查与合并

创建PR后，你的代码将接受团队成员的审查（Code Review）和自动化检查（CI/CD）。

- **如果有人提出修改意见**: 你只需在本地的`feature/data-parser`分支上继续修改、提交，然后再次`git push`。你的PR会自动更新。
- **当所有检查都通过，并且至少有一位同事批准后**: 你或项目负责人就可以点击“Merge”按钮，将你的代码正式并入`develop`分支。

### 第5.1步：自动化检查（CI）简介

为保证代码质量，我们在仓库中启用了持续集成（CI），自动在每次 Push 和 Pull Request 时构建项目并运行测试。仓库内已添加 GitHub Actions 工作流文件：`.github/workflows/ci.yml`。该工作流会：

- 在 `ubuntu-latest` 和 `windows-latest` 上构建项目（Release）。
- 运行项目测试（ctest），并在失败时在 PR 中显示错误信息。
- **代码格式检查**：使用 clang-format 确保代码风格一致。
- **静态分析**：使用 clang-tidy 检查潜在的代码问题。
- 上传测试输出作为构建产物，便于问题排查。

**你需要注意的**：
- 当你提交 PR 后，GitHub 会自动触发这些检查。
- 如果格式检查失败，请在本地运行：`find radar_mvp/src radar_mvp/include -name "*.cpp" -o -name "*.h" | xargs clang-format -i`
- 如果 CI 失败，请根据输出修复问题并再次 Push。
- CI 通过是合并 PR 的必要条件之一。

### 第5.2步：使用PR模板

创建 Pull Request 时，GitHub 会自动加载我们的 PR 模板（`.github/pull_request_template.md`），其中包含：
- 变更类型选择（新功能、Bug修复等）
- 变更描述和测试情况
- 审查清单（确保你完成了所有必要步骤）
- 破坏性变更说明

**请认真填写PR模板**，这有助于审查者快速理解你的变更，加速审查流程。

### 如何启用分支保护（强制通过 CI 才能合并）

项目管理员可以在 GitHub 仓库设置中开启分支保护规则，推荐的设置：

1. 在 `Settings -> Branches` 下新增规则，选择 `develop`（或 `main`）作为受保护分支。
2. 勾选 `Require status checks to pass before merging`，并添加 CI 工作流（例如 `CI / build-and-test`）。
3. 勾选 `Require pull request reviews before merging`，设置需要的审批人数（例如 1 或 2）。
4. 勾选 `Include administrators`（视团队政策而定），确保规则对管理员也生效。

---

## 黄金法则（务必遵守）

1.  **绝不**直接向 `main` 或 `develop` 分支推送代码。
2.  **务必**从最新的 `develop` 分支创建你的功能分支。
3.  **务必**为你的每个任务创建一个功能分支。
4.  **务必**通过 Pull Request 来合并代码。
5.  **合并后**及时删除已完成的功能分支。

---

现在，你已经掌握了在`Radar MVP`项目中贡献代码的全过程。如果对任何命令或概念感到困惑，请随时查阅 **[Git完整使用指南.md](./Git完整使用指南.md)** 或向你的导师、同事提问。

祝你编码愉快！
