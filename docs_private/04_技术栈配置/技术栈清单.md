# 技术栈清单

- **标题**: AI协作开发技术栈版本管理清单
- **当前版本**: v1.0
- **最后更新**: 2025-09-10
- **负责人**: Kelin

---

## 核心技术栈

### 🔧 编程语言和标准
```yaml
primary_language:
  name: "C++"
  standard: "C++17"
  reason: "现代C++特性支持，RAII和智能指针，性能和安全性平衡"
  alternatives: ["C++20 (未来升级)", "C++14 (向下兼容)"]

gpu_language:
  name: "CUDA C++"
  version: "12.2+"
  compute_capability: ["6.0", "6.1", "7.0", "7.5", "8.0", "8.6", "8.9"]
  reason: "NVIDIA GPU加速计算，FFT和信号处理优化"

configuration_language:
  name: "YAML"
  version: "1.2"
  reason: "人类可读的配置格式，支持复杂嵌套结构"
```

### 🏗️ 构建系统和工具
```yaml
build_system:
  primary:
    name: "CMake"
    version: "3.20+"
    reason: "跨平台构建，CUDA支持，现代CMake特性"

  generator:
    name: "Ninja"
    version: "1.10+"
    reason: "快速增量构建，并行构建优化"
    alternatives: ["Make", "Visual Studio"]

package_manager:
  primary:
    name: "vcpkg"
    version: "2023.08+"
    reason: "微软维护，CMake集成好，Windows支持佳"

  backup:
    name: "Conan"
    version: "2.0+"
    reason: "备用包管理器，更灵活的依赖管理"
```

### 🎯 编译器支持矩阵

#### 主要编译器版本
| 编译器        | 最低版本 | 推荐版本 | 最新测试 | 平台支持    | 状态   |
| ------------- | -------- | -------- | -------- | ----------- | ------ |
| **GCC**       | 9.0      | 11.3     | 12.2     | Linux       | ✅ 主要 |
| **Clang**     | 12.0     | 14.0     | 15.0     | Linux/macOS | ✅ 支持 |
| **MSVC**      | 19.28    | 19.30    | 19.35    | Windows     | ✅ 支持 |
| **Intel ICC** | 2021.1   | 2023.1   | 2023.2   | Linux       | 🧪 实验 |

#### 编译器特性支持
```cpp
// C++17 特性使用情况
namespace radar {
    // ✅ 使用的 C++17 特性
    - std::optional, std::variant
    - std::string_view
    - structured bindings
    - if constexpr
    - fold expressions
    - std::filesystem

    // ❌ 避免的特性 (兼容性考虑)
    - std::execution (GCC 支持不完整)
    - std::jthread (需要 C++20)
    - concepts (需要 C++20)
}
```

---

## 第三方库生态

### 📚 核心依赖库

#### 系统和工具库
```yaml
boost:
  version: "1.75.0+"
  components: ["system", "filesystem", "thread", "asio", "program_options"]
  license: "Boost Software License"
  purpose: "高质量C++库，系统编程基础"
  alternatives: ["std库 (C++20后可部分替代)"]

yaml_cpp:
  version: "0.7.0+"
  license: "MIT"
  purpose: "YAML配置文件解析"
  alternatives: ["nlohmann/json (JSON格式)", "toml++ (TOML格式)"]

spdlog:
  version: "1.9.0+"
  license: "MIT"
  purpose: "高性能日志库"
  features: ["异步日志", "多线程安全", "格式化支持"]
  alternatives: ["glog", "boost::log"]
```

#### 计算和数学库
```yaml
cuda_toolkit:
  version: "12.2+"
  components: ["cudart", "cufft", "cublas", "curand", "cusparse"]
  license: "NVIDIA Software License"
  purpose: "GPU加速计算"
  compute_capabilities: ["6.0+"]

eigen3:
  version: "3.4.0+"
  license: "MPL2"
  purpose: "线性代数运算，矩阵操作"
  features: ["SIMD优化", "表达式模板", "稀疏矩阵"]
  alternatives: ["Intel MKL", "OpenBLAS"]
  status: "可选依赖"

intel_mkl:
  version: "2023.0+"
  license: "Intel Simplified Software License"
  purpose: "优化的数学内核库"
  features: ["BLAS/LAPACK", "FFT", "向量数学"]
  status: "可选依赖 (性能优化)"
```

#### 图形和UI库
```yaml
opengl:
  version: "4.5+"
  purpose: "GPU图形渲染"
  required_extensions: ["ARB_direct_state_access", "ARB_buffer_storage"]

glfw:
  version: "3.3+"
  license: "zlib/libpng"
  purpose: "窗口管理和输入处理"
  alternatives: ["SDL2", "GLUT"]

glew:
  version: "2.2.0+"
  license: "Modified BSD, MIT"
  purpose: "OpenGL扩展加载"
  alternatives: ["glad", "gl3w"]

imgui:
  version: "1.89+"
  license: "MIT"
  purpose: "即时模式GUI库"
  features: ["调试界面", "参数调节", "数据可视化"]
  status: "可选依赖"
```

### 🧪 测试和开发库

#### 测试框架
```yaml
googletest:
  version: "1.12.0+"
  components: ["gtest", "gmock"]
  license: "BSD-3-Clause"
  purpose: "单元测试和模拟框架"
  features: ["参数化测试", "死亡测试", "类型化测试"]

google_benchmark:
  version: "1.7.0+"
  license: "Apache-2.0"
  purpose: "微基准测试"
  features: ["统计分析", "时间测量", "内存使用测量"]
  status: "开发依赖"

catch2:
  version: "3.3.0+"
  license: "BSL-1.0"
  purpose: "现代C++测试框架"
  status: "备用测试框架"
```

#### 代码质量工具
```yaml
clang_tidy:
  version: "14.0+"
  purpose: "静态代码分析"
  checks: ["modernize-*", "performance-*", "readability-*"]

clang_format:
  version: "14.0+"
  purpose: "代码格式化"
  style: "项目自定义 (.clang-format)"

cppcheck:
  version: "2.9+"
  license: "GPL-3.0"
  purpose: "静态分析工具"
  status: "可选"
```

---

## 版本兼容性矩阵

### 🔄 主要组件兼容性

#### CUDA 兼容性表
| CUDA版本 | 最低驱动版本 | GCC支持 | MSVC支持    | 架构支持 | 状态   |
| -------- | ------------ | ------- | ----------- | -------- | ------ |
| 12.2     | 535.54+      | ≤12     | 19.30-19.37 | 6.0-8.9  | ✅ 推荐 |
| 12.1     | 530.30+      | ≤12     | 19.30-19.36 | 6.0-8.9  | ✅ 支持 |
| 12.0     | 525.60+      | ≤11     | 19.30-19.35 | 6.0-8.9  | ⚠️ 旧版 |
| 11.8     | 520.61+      | ≤11     | 19.29-19.34 | 6.0-8.6  | ❌ 过时 |

#### Boost 兼容性表
| Boost版本 | C++标准 | GCC | Clang | MSVC   | 特性     |
| --------- | ------- | --- | ----- | ------ | -------- |
| 1.82      | C++17   | 9+  | 12+   | 19.30+ | 最新特性 |
| 1.80      | C++17   | 9+  | 12+   | 19.28+ | ✅ 推荐   |
| 1.75      | C++17   | 9+  | 12+   | 19.28+ | ✅ 最低   |
| 1.70      | C++14   | 7+  | 10+   | 19.20+ | ❌ 过时   |

### 🎯 平台支持矩阵

#### 操作系统支持
| 平台        | 版本      | 架构      | 编译器    | GPU支持 | 状态   |
| ----------- | --------- | --------- | --------- | ------- | ------ |
| **Ubuntu**  | 22.04 LTS | x64       | GCC 11+   | CUDA    | ✅ 主要 |
| **Ubuntu**  | 20.04 LTS | x64       | GCC 9+    | CUDA    | ✅ 支持 |
| **CentOS**  | Stream 9  | x64       | GCC 11+   | CUDA    | ✅ 支持 |
| **Windows** | 10/11     | x64       | MSVC 2022 | CUDA    | ✅ 支持 |
| **macOS**   | 12+       | x64/ARM64 | Clang     | Metal   | 🧪 实验 |

#### 硬件架构支持
```yaml
cpu_architectures:
  x86_64:
    status: "完全支持"
    optimizations: ["AVX2", "FMA", "SSE4.2"]

  aarch64:
    status: "实验性支持"
    optimizations: ["NEON", "ARM64 intrinsics"]
    limitations: ["无CUDA支持", "性能未优化"]

gpu_architectures:
  nvidia:
    supported: ["Maxwell", "Pascal", "Volta", "Turing", "Ampere", "Ada Lovelace"]
    compute_capabilities: ["6.0", "6.1", "7.0", "7.5", "8.0", "8.6", "8.9"]

  amd:
    status: "计划中"
    technology: "ROCm/HIP"

  intel:
    status: "评估中"
    technology: "oneAPI/SYCL"
```

---

## 性能和优化配置

### ⚡ 编译器优化配置

#### Release构建优化
```cmake
# 高性能Release配置
set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG -march=native -mtune=native")

# CUDA优化
set(CMAKE_CUDA_FLAGS_RELEASE "-O3 -DNDEBUG --use_fast_math")

# 链接时优化 (LTO)
if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU" OR CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
    set(CMAKE_INTERPROCEDURAL_OPTIMIZATION_RELEASE TRUE)
endif()

# 特定优化选项
target_compile_options(radar_core PRIVATE
    $<$<CONFIG:Release>:
        $<$<CXX_COMPILER_ID:GNU>:-funroll-loops -ffast-math>
        $<$<CXX_COMPILER_ID:Clang>:-funroll-loops -ffast-math>
        $<$<CXX_COMPILER_ID:MSVC>:/fp:fast /O2>
    >
)
```

#### Debug构建配置
```cmake
# Debug构建配置
set(CMAKE_CXX_FLAGS_DEBUG "-O0 -g3 -DDEBUG -fno-omit-frame-pointer")

# 调试信息增强
if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
    set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -ggdb3")
endif()

# 运行时检查
target_compile_options(radar_core PRIVATE
    $<$<CONFIG:Debug>:
        $<$<CXX_COMPILER_ID:GNU>:-fsanitize=address -fsanitize=undefined>
        $<$<CXX_COMPILER_ID:Clang>:-fsanitize=address -fsanitize=undefined>
    >
)
```

### 🎯 CUDA性能配置

#### CUDA编译配置
```cmake
# CUDA 架构配置
set(CMAKE_CUDA_ARCHITECTURES "60;61;70;75;80;86;89")

# CUDA 编译选项
set(CMAKE_CUDA_FLAGS "--extended-lambda --expt-relaxed-constexpr")

# 分离编译 (大型项目)
set_property(TARGET radar_gpu_lib PROPERTY CUDA_SEPARABLE_COMPILATION ON)

# PTX 生成 (向前兼容)
set_property(TARGET radar_gpu_lib PROPERTY CUDA_PTX_COMPILATION ON)
```

#### GPU内存优化
```yaml
memory_optimization:
  unified_memory:
    enabled: true
    reason: "简化内存管理，提高开发效率"

  memory_pools:
    enabled: true
    pool_size: "1GB"
    reason: "减少内存分配开销"

  pinned_memory:
    enabled: true
    size: "512MB"
    reason: "提高CPU-GPU传输速度"
```

---

## 安全和合规性

### 🔒 许可证管理

#### 开源许可证兼容性
```yaml
compatible_licenses:
  - "MIT"
  - "BSD-2-Clause"
  - "BSD-3-Clause"
  - "Apache-2.0"
  - "Boost Software License"
  - "zlib/libpng"

conditional_licenses:
  - name: "GPL-3.0"
    condition: "仅用于开发工具，不链接到最终产品"

  - name: "LGPL-2.1"
    condition: "动态链接，提供源码访问"

incompatible_licenses:
  - "GPL-2.0"
  - "AGPL-3.0"
  - "Commercial restrictive licenses"
```

#### 安全审计配置
```yaml
security_scanning:
  dependency_check:
    tool: "OWASP Dependency Check"
    frequency: "每月"

  static_analysis:
    tools: ["Clang Static Analyzer", "PVS-Studio", "SonarQube"]
    frequency: "每次CI构建"

  vulnerability_database:
    sources: ["NVD", "OSV", "GitHub Advisory Database"]
    update_frequency: "每日"
```

---

## 升级和维护策略

### 📈 技术栈升级路线图

#### 短期计划 (6个月内)
```yaml
q1_2025:
  - boost: "1.82 -> 1.84"
  - cuda: "12.2 -> 12.3"
  - cmake: "3.26 -> 3.27"

q2_2025:
  - cpp_standard: "评估C++20升级"
  - eigen: "3.4 -> 4.0 (beta)"
  - googletest: "1.12 -> 1.13"
```

#### 长期计划 (1-2年)
```yaml
major_upgrades:
  cpp20_migration:
    timeline: "2025年底"
    benefits: ["Concepts", "Coroutines", "Modules"]
    risks: ["编译器兼容性", "构建时间增加"]

  cuda_13:
    timeline: "2025年中"
    benefits: ["新架构支持", "性能改进"]
    dependencies: ["驱动更新", "硬件兼容性"]

  build_system:
    evaluation: ["Bazel", "Buck2", "Meson"]
    timeline: "评估阶段"
```

### 🔄 版本更新流程

#### 依赖更新检查清单
```markdown
## 更新前检查
- [ ] 查看更新日志 (CHANGELOG)
- [ ] 检查破坏性变更 (Breaking Changes)
- [ ] 验证许可证兼容性
- [ ] 评估安全漏洞修复

## 测试验证
- [ ] 本地构建测试
- [ ] 单元测试通过
- [ ] 集成测试通过
- [ ] 性能基准测试
- [ ] 兼容性验证

## 发布流程
- [ ] 更新版本文档
- [ ] 更新CI/CD配置
- [ ] 通知团队成员
- [ ] 监控生产环境
```

#### 回滚策略
```yaml
rollback_triggers:
  - "构建失败率 > 10%"
  - "性能下降 > 15%"
  - "严重功能回归"
  - "安全问题引入"

rollback_procedure:
  1. "停止新版本部署"
  2. "恢复上一版本配置"
  3. "验证系统功能"
  4. "分析失败原因"
  5. "制定修复计划"
```

---

## 技术栈监控

### 📊 版本跟踪仪表板

#### 自动化监控脚本
```bash
#!/bin/bash
# scripts/check_tech_stack_versions.sh

echo "=== 技术栈版本检查 ==="

# 检查核心工具版本
echo "核心工具:"
echo "  CMake: $(cmake --version | head -1 | cut -d' ' -f3)"
echo "  GCC: $(gcc --version | head -1 | cut -d' ' -f4)"
echo "  CUDA: $(nvcc --version | grep release | cut -d' ' -f5-6)"

# 检查库版本
echo -e "\n依赖库:"
pkg-config --modversion boost 2>/dev/null && echo "  Boost: $(pkg-config --modversion boost)" || echo "  Boost: 未检测到"
pkg-config --modversion yaml-cpp 2>/dev/null && echo "  yaml-cpp: $(pkg-config --modversion yaml-cpp)" || echo "  yaml-cpp: 未检测到"

# 检查是否有可用更新
echo -e "\n检查更新..."
# 这里可以集成包管理器的更新检查
```

#### 依赖关系图生成
```python
#!/usr/bin/env python3
# scripts/generate_dependency_graph.py

import subprocess
import json
from graphviz import Digraph

def generate_dependency_graph():
    """生成技术栈依赖关系图"""

    dot = Digraph(comment='Technology Stack Dependencies')
    dot.attr(rankdir='TB')

    # 定义节点
    dot.node('cpp17', 'C++17', shape='box', style='filled', fillcolor='lightblue')
    dot.node('cuda', 'CUDA 12.2+', shape='box', style='filled', fillcolor='lightgreen')
    dot.node('cmake', 'CMake 3.20+', shape='box', style='filled', fillcolor='lightyellow')

    # 定义依赖关系
    dot.edge('cpp17', 'boost')
    dot.edge('cpp17', 'yaml-cpp')
    dot.edge('cuda', 'cufft')
    dot.edge('cmake', 'ninja')

    # 输出图形
    dot.render('tech_stack_dependencies', format='png')
    print("依赖关系图已生成: tech_stack_dependencies.png")

if __name__ == "__main__":
    generate_dependency_graph()
```

---

## 变更记录

| 版本 | 日期       | 修改人 | 变更摘要                     |
| :--- | :--------- | :----- | :--------------------------- |
| v1.0 | 2025-09-10 | Kelin  | 创建技术栈清单和版本管理方案 |
